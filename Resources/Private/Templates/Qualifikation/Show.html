{namespace tv = Pmwebdesign\Staffm\ViewHelpers}
<f:layout name="Default" />

This Template is responsible for displaying a single view for a domain object

If you modify this template, do not forget to change the overwrite settings
in /Configuration/ExtensionBuilder/settings.yaml:
  Resources:
    Private:
      Templates:
        Show.html: keep

Otherwise your changes will be overwritten the next time you save the extension in the extension builder

<f:section name="main">
<h1><f:translate id="staffm.qualifikation.show.headline" /></h1>

<f:flashMessages />
<f:render partial="Qualifikation/Properties" arguments="{qualifikation:qualifikation}" /><br />
<div class="btn-group">
    <f:if condition="{key} == 'vonMit'">
        <f:then>        
            <f:link.action class="btn btn-default" controller="Mitarbeiter" action="show" arguments="{mitarbeiter:mitarbeiter, search:standardsearch}"><f:translate id="staffm.back" /> (<f:translate key="tx_staffm_domain_model_mitarbeiter" />)</f:link.action>
        </f:then>
        <f:else>
            <f:link.action section="q{qualifikation.uid}" class="btn btn-default" action="list" arguments="{maid: 'maid', search:search}"><f:translate id="staffm.back" /></f:link.action>
        </f:else>        
    </f:if>
    <f:link.action title="Die Liste in Excel ausgeben" id="excelExport" class="btn btn-default" action="export" arguments="{qualifikation:qualifikation}" name="excelExport" >
        <f:image class="tx_staffm icon" src="typo3conf/ext/staffm/Resources/Public/Icons/Excel.png" />
        Excel Export
    </f:link.action> 
</div>
<br /><br />
<h2><f:translate id="staffm.text.zugeordnete" /> <f:translate key="tx_staffm_domain_model_mitarbeiter" /> (<f:count subject="{qualifikation.employeequalifications}" />)</h2>
<table class="tx_staffm">    
    <tr>
        <th></th>
        <th><f:translate key="tx_staffm_domain_model_mitarbeiter.personalnummer" /></th>
        <th><f:translate key="tx_staffm_domain_model_mitarbeiter.last_name" /></th>
        <th><f:translate key="tx_staffm_domain_model_mitarbeiter.first_name" /></th>
        <th><f:translate key="tx_staffm_domain_model_mitarbeiter.title" /></th>
        <th><f:translate key="tx_staffm_domain_model_mitarbeiter.telephone" /></th>
        <!-- TODO: Authorization just for supervisors -->
        <th><f:translate key="tx_staffm_domain_model_qualifikation.status" /></th>
    </tr> 
    <f:for each="{qualifikation.employeequalifications}" as="ma" reverse="TRUE">   
        <tr id="ma{ma.uid}">
            <td>
                <f:if condition="{ma.employee.image}">
                    <f:for each="{ma.employee.image}" as="img" key="key" iteration="iterator">    
                        <f:if condition="{iterator.isFirst}">
                            <f:link.action controller="Mitarbeiter" action="showKst" arguments="{ma : ma, qualifikation:qualifikation, key: 'auswahlKst'}"><f:image class="tx_staffm profilbild klein" src="{img.originalResource.publicUrl}" /></f:link.action>                                            
                        </f:if>
                    </f:for>                        
                </f:if>                        
            </td>
            <td><f:link.action controller="Mitarbeiter" action="showKst" arguments="{ma : ma.employee, qualifikation:qualifikation, key: 'auswahlKst', search:search}">{ma.employee.personalnummer}</f:link.action></td>
            <td><f:link.action controller="Mitarbeiter" action="showKst" arguments="{ma : ma.employee, qualifikation:qualifikation, key: 'auswahlKst', search:search}">{ma.employee.lastName}</f:link.action></td>
            <td><f:link.action controller="Mitarbeiter" action="showKst" arguments="{ma : ma.employee, qualifikation:qualifikation, key: 'auswahlKst', search:search}">{ma.employee.firstName}</f:link.action></td>
            <td><f:link.action controller="Mitarbeiter" action="showKst" arguments="{ma : ma.employee, qualifikation:qualifikation, key: 'auswahlKst', search:search}">{ma.employee.title}</f:link.action></td>
            <td><f:link.action controller="Mitarbeiter" action="showKst" arguments="{ma : ma.employee, qualifikation:qualifikation, key: 'auswahlKst', search:search}">{ma.employee.telephone}</f:link.action></td>
            <td><f:link.action controller="Mitarbeiter" action="showKst" arguments="{ma : ma.employee, qualifikation:qualifikation, key: 'auswahlKst', search:search}" title="{qualifikation.status.{ma.status}}">{ma.status}</f:link.action></td>
            <!-- TODO: Authorization just for supervisors -->
            <f:for each="{ma.employeequalifications}" as="employeequalification">
                <f:if condition="{qualifikation} == {employeequalification.qualification}">
                    <td><f:link.action controller="Mitarbeiter" action="showKst" arguments="{ma : ma.employee, qualifikation:qualifikation, key: 'auswahlKst', search:search}"></f:link.action></td>
                </f:if>
            </f:for>
            <f:security.ifHasRole role="PA">
                <f:then>
                    <td class="staffmmobilehidden nobackground">
                        <div class="btn-group">
                            <f:link.action class="btn btn-secondary btn-sm" title="{ma.employee.firstName} {ma.employee.lastName} bearbeiten" controller="Mitarbeiter" action="edit" arguments="{mitarbeiter : ma.employee}"><f:translate id="staffm.edit" /></f:link.action>
                            <f:link.action class="btn btn-danger btn-sm" controller="Mitarbeiter" action="delete" arguments="{mitarbeiter : ma.employee}"><f:translate id="staffm.delete" /></f:link.action>
                        </div>
                    </td>
                </f:then>
                <f:else>
                    <f:if condition="{aktuser.position} != 0">
                        <!-- Kostenstellenverantwortung prÃ¼fen -->                                
                        <f:for each="{kostenstellen}" as="kst">                                    
                            <f:if condition="{kst.uid} == {ma.employee.kostenstelle.uid}">
                                <td><f:link.action class="btn btns-sm btn-secondary" controller="Mitarbeiter" action="editKst" arguments="{ma : ma.employee, qualifikation:qualifikation, key: 'auswahlKst'}"><f:translate id="staffm.edit" /></f:link.action></td>
                            </f:if>    
                        </f:for>
                    </f:if>
                </f:else>
            </f:security.ifHasRole>
        </tr>
    </f:for>    
</table>
</f:section>